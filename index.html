<!DOCTYPE html>
<html lang="ru">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¶–∏–∫–ª –î–æ–ª–≥–∞</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Yandex Games SDK -->
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Yandex Games SDK
        (function() {
            var script = document.createElement('script');
            script.src = 'https://yandex.ru/games/sdk/v2';
            script.async = true;
            
            script.onload = function() {
                console.log('[Yandex SDK] SDK –∑–∞–≥—Ä—É–∂–µ–Ω');
                YaGames.init()
                    .then(function(ysdk) {
                        console.log('[Yandex SDK] SDK –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω:', ysdk);
                        window.ysdk = ysdk;
                        
                        // –£–≤–µ–¥–æ–º–ª—è–µ–º –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ SDK
                        window.dispatchEvent(new CustomEvent('ysdk-ready', { detail: ysdk }));
                    })
                    .catch(function(error) {
                        console.error('[Yandex SDK] –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                        
                        // –ü–æ–ø—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                        console.log('[Yandex SDK] –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é...');
                        if (window.YaGames && typeof window.YaGames.init === 'function') {
                            window.YaGames.init()
                                .then(function(ysdk) {
                                    console.log('[Yandex SDK] –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞:', ysdk);
                                    window.ysdk = ysdk;
                                    window.dispatchEvent(new CustomEvent('ysdk-ready', { detail: ysdk }));
                                })
                                .catch(function(altError) {
                                    console.error('[Yandex SDK] –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–∂–µ –Ω–µ —É–¥–∞–ª–∞—Å—å:', altError);
                                });
                        }
                    });
            };
            
            script.onerror = function() {
                console.error('[Yandex SDK] –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ SDK');
                
                // –ü–æ–ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å SDK –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
                const urlParams = new URLSearchParams(window.location.search);
                const sdkUrl = urlParams.get('sdk');
                if (sdkUrl) {
                    console.log('[Yandex SDK] –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å SDK –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:', sdkUrl);
                    var altScript = document.createElement('script');
                    altScript.src = decodeURIComponent(sdkUrl);
                    altScript.async = true;
                    altScript.onload = function() {
                        console.log('[Yandex SDK] SDK –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞');
                        if (window.YaGames && typeof window.YaGames.init === 'function') {
                            window.YaGames.init()
                                .then(function(ysdk) {
                                    console.log('[Yandex SDK] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —É—Å–ø–µ—à–Ω–∞:', ysdk);
                                    window.ysdk = ysdk;
                                    window.dispatchEvent(new CustomEvent('ysdk-ready', { detail: ysdk }));
                                })
                                .catch(function(error) {
                                    console.error('[Yandex SDK] –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:', error);
                                });
                        }
                    };
                    altScript.onerror = function() {
                        console.error('[Yandex SDK] –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å SDK –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞');
                    };
                    document.head.appendChild(altScript);
                }
            };
            
            document.head.appendChild(script);
        })();
    </script>
</head>
<body>

    <!-- –ö–ù–û–ü–ö–ê  
    <button id="dev-menu-btn">Dev</button>-->
    <!-- <button id="switch-style2-btn" class="style2-switch-btn" style="position:fixed;top:10px;right:70px;z-index:1000;">Style 2</button> -->
    <div id="dev-menu-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width:800px;">
            <h2>–ú–µ–Ω—é —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</h2>
            <div id="dev-menu-content" class="dev-menu-two-columns">
                <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –†–µ—Å—É—Ä—Å—ã –∏ –ø—Ä–µ–¥–º–µ—Ç—ã -->
                <div class="dev-left-column">
                    <div class="dev-section">
                        <h3>–†–µ—Å—É—Ä—Å—ã</h3>
                        <div class="dev-buttons">
                            <button id="dev-add-coins" class="dev-button money">+1000 –º–æ–Ω–µ—Ç</button>
                            <button id="dev-add-tickets" class="dev-button ticket">+100 —Ç–∞–ª–æ–Ω–æ–≤</button>
                            <button id="dev-set-interest" class="dev-button">–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É 50%</button>
                        </div>
                    </div>

                    <div class="dev-section">
                        <h3>–ü—Ä–µ–¥–º–µ—Ç—ã</h3>
                        <div class="dev-item-control">
                            <select id="dev-item-select" class="dev-select"></select>
                            <button id="dev-give-item" class="dev-button">–í—ã–¥–∞—Ç—å</button>
                        </div>
                    </div>

                    <div class="dev-section">
                        <h3>–ü–∞—Å—Å–∏–≤–∫–∏</h3>
                        <div class="dev-item-control">
                            <select id="dev-passive-select" class="dev-select"></select>
                            <button id="dev-give-passive" class="dev-button">–î–æ–±–∞–≤–∏—Ç—å</button>
                        </div>
                        <div id="dev-active-passives" class="dev-active-passives" style="margin-top: 10px; font-size: 12px; color: var(--text-color);">
                            <strong>–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–∞—Å—Å–∏–≤–∫–∏:</strong>
                            <div id="dev-passives-list"></div>
                        </div>
                    </div>
                </div>

                <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ -->
                <div class="dev-right-column">
                    <div class="dev-section">
                        <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∞–Ω—Å–æ–≤</h3>
                        <div id="dev-symbol-chances" class="dev-chances"></div>
                        <button id="dev-apply-chances" class="dev-button">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —à–∞–Ω—Å—ã</button>
                    </div>

                    <div class="dev-section">
                        <h3>–£–¥–∞—á–∞</h3>
                        <div class="dev-luck-control">
                            <input type="number" id="dev-luck-input" class="dev-input" placeholder="–ó–Ω–∞—á–µ–Ω–∏–µ —É–¥–∞—á–∏">
                            <button id="dev-apply-luck" class="dev-button">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                        </div>
                        <div class="dev-test-control">
                            <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <input type="checkbox" id="dev-100-lose-mode" style="margin: 0;">
                                <span>100% –ø—Ä–æ–∏–≥—Ä—ã—à–Ω—ã–µ –ø—Ä–æ–∫—Ä—É—Ç—ã</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <button id="dev-close-menu" class="dev-button dev-close">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div class="game-container">
        <div class="main-panel">
            <div class="slot-area">
                <div id="slot-machine" class="slot-machine"></div>
                <div class="lever-container">
                    <div id="lever" class="lever"><div class="lever-handle"></div></div>
                    <div class="lever-base"></div>
                </div>
            </div>
            <div class="controls">
                <span>–ü—Ä–æ–∫—Ä—É—Ç–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å: <span id="spins-left">0</span></span>
                <button id="btn-end-turn">–ó–∞–∫–æ–Ω—á–∏—Ç—å —Ä–∞—É–Ω–¥</button>
                <button id="btn-show-run-stats" style="margin-left: 8px;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                <button id="btn-toggle-log" style="margin-left: 8px;">–õ–æ–≥</button>
                <button id="btn-leaderboard" class="btn-leaderboard" style="margin-left: 8px;">üèÜ –õ–∏–¥–µ—Ä—ã</button>
            </div>
             <!-- –ê–ú–£–õ–ï–¢–´ –ü–ï–†–ï–ú–ï–©–ï–ù–´ –°–Æ–î–ê -->
            <div class="ui-box">
                <h3>–ê–º—É–ª–µ—Ç—ã</h3>
                <div id="inventory-items" class="inventory-items"></div>
            </div>
        </div>

        <div class="ui-panel">
            <div class="ui-box">
                <h3>–¶–∏–∫–ª <span id="stat-run" style="color: var(--highlight-color);">1</span></h3>
                <div class="stats-grid compact-stats">
                    <span>–†–∞—É–Ω–¥:</span><span id="stat-turn">1 / 3</span>
                    <span style="color: var(--money-color);">–ù–∞–ª–∏—á–Ω—ã–µ:</span><span id="stat-coins" style="color: var(--money-color);">0</span>
                    <span style="color: var(--ticket-color);">–¢–∞–ª–æ–Ω—ã:</span><span id="stat-tickets" style="color: var(--ticket-color);">0</span>
                    <span style="color: var(--luck-color);">–£–¥–∞—á–∞:</span><span id="stat-luck" style="color: var(--luck-color);">0</span>
                </div>
            </div>
            <div class="ui-box">
                <h3>–ë–∞–Ω–∫ <span id="bank-balance" style="color: var(--money-color);">0</span></h3>
                <div class="stats-grid">
                    <span>–¶–ï–õ–¨:</span><span id="stat-debt" style="color: var(--danger-color);">50</span>
                    <span>–°—Ç–∞–≤–∫–∞:</span><span><span id="atm-interest-rate">3</span>%</span>
                </div>
                <div class="atm-actions" style="position: relative; z-index: 10;">
                    <button id="btn-deposit">–í–Ω–µ—Å—Ç–∏ ‚ñº</button>
                    <div id="deposit-dropdown" class="deposit-dropdown hidden">
                        <div class="deposit-option" data-type="all">–í–Ω–µ—Å—Ç–∏ –≤—Å—ë</div>
                        <div class="deposit-option" data-type="except-7">–í–Ω–µ—Å—Ç–∏ –≤—Å—ë, –∫—Ä–æ–º–µ 7 –ø—Ä–æ–∫—Ä—É—Ç–æ–≤</div>
                        <div class="deposit-option" data-type="except-3">–í–Ω–µ—Å—Ç–∏ –≤—Å—ë, –∫—Ä–æ–º–µ 3 –ø—Ä–æ–∫—Ä—É—Ç–æ–≤</div>
                        <div class="deposit-option" data-type="half">–í–Ω–µ—Å—Ç–∏ –ø–æ–ª–æ–≤–∏–Ω—É</div>
                    </div>
                </div>
                <div id="early-payoff-section" class="early-payoff-section">
                    <button id="btn-pay-debt-early">–í—ã–ø–ª–∞—Ç–∏—Ç—å –¥–æ–ª–≥ –¥–æ—Å—Ä–æ—á–Ω–æ</button>
                    <div id="early-payoff-bonus-info" class="early-payoff-info"></div>
                </div>
            </div>
            <div class="ui-box">
                <h3>–ú–∞–≥–∞–∑–∏–Ω <button id="btn-reroll-shop" style="float: right; font-size: 12px; padding: 5px 8px;">Reroll (2üéüÔ∏è)</button></h3>
                <div id="shop-items" class="shop-items"></div>
            </div>
        </div>
    </div>

    <!-- –í—Å–ø–ª—ã–≤–∞—é—â–∞—è –ø–∞–Ω–µ–ª—å –ª–æ–≥–∞ -->
    <div id="log-panel-wrapper" class="log-panel-wrapper">
        <div class="log-panel-header">
            <h3>–õ–æ–≥ –†–∞—É–Ω–¥–∞</h3>
            <button id="btn-close-log" class="log-panel-close">&times;</button>
        </div>
        <div id="log-panel" class="log-panel" style="flex-grow: 1; overflow-y: auto; padding: 10px;">
            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ª–æ–≥–∞, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–µ skript.js -->
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="start-screen" class="modal-overlay">
        <div class="modal-content">
            <h2>–¶–∏–∫–ª –î–æ–ª–≥–∞</h2>
            <p>–£ –≤–∞—Å –µ—Å—Ç—å 3 —Ä–∞—É–Ω–¥–∞ (–¥–Ω—è), —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å —Å—É–º–º—É –¥–ª—è –≤—ã–ø–ª–∞—Ç—ã –¥–æ–ª–≥–∞. –í–Ω–æ—Å–∏—Ç–µ –¥–µ–Ω—å–≥–∏ –≤ –±–∞–Ω–∫, –ø–æ–∫—É–ø–∞–π—Ç–µ –ø—Ä–æ–∫—Ä—É—Ç—ã –∏ –∞–º—É–ª–µ—Ç—ã, –∏ –º–æ–ª–∏—Ç–µ—Å—å –æ–± —É–¥–∞—á–µ. –ï—Å–ª–∏ –∫ –∫–æ–Ω—Ü—É 3-–≥–æ –¥–Ω—è —É –≤–∞—Å –Ω–µ –±—É–¥–µ—Ç –Ω—É–∂–Ω–æ–π —Å—É–º–º—ã... –≤—ã –ø—Ä–æ–≤–∞–ª–∏—Ç–µ—Å—å –≤ —è–º—É.</p>
            <div id="start-debt-amount" style="color: var(--danger-color); font-size: 1.5em; font-weight: bold; margin: 10px 0; animation: debt-pulse 1.2s infinite alternate;">–í—Å–µ–≥–æ –¥–æ–ª–≥: <span id="stat-debt" style="color: var(--danger-color);">88,888,888 –º–ª–Ω</span>üí∞</div>
            <button id="btn-show-tutorial" style="margin-bottom: 10px;">–ö–∞–∫ –∏–≥—Ä–∞—Ç—å?</button>
            <button id="btn-start-game">–ù–∞—á–∞—Ç—å</button>
        </div>
    </div>
    <div id="game-over-screen" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="shake">–í–´ –ü–†–û–í–ê–õ–ò–õ–ò–°–¨ –í –Ø–ú–£</h2>
            <p>–°—É–¥–Ω—ã–π –¥–µ–Ω—å –Ω–∞—Å—Ç–∞–ª, –∞ –¥–µ–Ω–µ–≥ –Ω–µ—Ç. –¢—å–º–∞ –ø–æ–≥–ª–æ—â–∞–µ—Ç –≤–∞—Å.</p>
            <p>–í—ã –ø—Ä–æ–¥–µ—Ä–∂–∞–ª–∏—Å—å: <span id="final-run"></span> —Ü–∏–∫–ª(–æ–≤).</p>
            <button id="btn-leaderboard-gameover" class="btn-leaderboard" style="margin-bottom: 10px;">üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</button>
            <button id="btn-restart-game">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
        </div>
    </div>
    <div id="spin-purchase-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 id="purchase-modal-title">–†–∞—É–Ω–¥ 1. –í—Ä–µ–º—è –∑–∞–∫—É–ø–∞—Ç—å—Å—è.</h2>
            <p>–í–∞—à–∏ –Ω–∞–ª–∏—á–Ω—ã–µ: <span id="purchase-modal-coins" style="color: var(--money-color)">0</span>. –í—ã–±–µ—Ä–∏—Ç–µ, –∫–∞–∫ –≤—ã –ø–æ—Ç—Ä–∞—Ç–∏—Ç–µ –¥–µ–Ω—å–≥–∏ —Å–µ–≥–æ–¥–Ω—è.</p>
            <p>–¶–∏–∫–ª –¥–æ–ª–≥–∞: <span id="purchase-modal-debt" style="color: var(--danger-color)">0</span></p>
            <div class="modal-actions">
                <button id="buy-spins-7">7 –ø—Ä–æ–∫—Ä—É—Ç–æ–≤ + 1 —Ç–∞–ª–æ–Ω (–°—Ç–æ–∏–º–æ—Å—Ç—å: 10üí∞)</button>
                <button id="buy-spins-3">3 –ø—Ä–æ–∫—Ä—É—Ç–∞ + 2 —Ç–∞–ª–æ–Ω–∞ (–°—Ç–æ–∏–º–æ—Å—Ç—å: 7üí∞)</button>
                <button id="buy-spin-1">1 –ø—Ä–æ–∫—Ä—É—Ç (3üí∞, –±–µ–∑ —Ç–∞–ª–æ–Ω–æ–≤)</button>
                <button id="watch-ad-for-spins" style="background-color: #ff6b35; border-color: #ff6b35; color: white;">üì∫ –°–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∫–ª–∞–º—É –∑–∞ 3 –ø—Ä–æ–∫—Ä—É—Ç–∞</button>
                <button id="buy-nothing">–ù–∏—á–µ–≥–æ. –Ø —Å–ø—Ä–∞–≤–ª—é—Å—å.</button>
            </div>
            <div id="spin-cost-tooltip" class="spin-cost-tooltip" style="display:none; position:absolute; z-index:2000; font-size:0.98em; background:var(--cell-bg,#232323); border:1px solid var(--border-color,#444); border-radius:6px; padding:10px; color:var(--text-color,#fff); box-shadow:0 2px 12px #0005; pointer-events:none; transition:opacity 0.15s; opacity:0;"></div>
            <button id="btn-planning" style="margin-top: 10px; background-color: var(--ticket-color); border-color: var(--ticket-color);">üìã –†–µ–∂–∏–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</button>
        </div>
    </div>
    <!-- –ù–û–í–û–ï –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –†–ï–ñ–ò–ú–ê –ü–õ–ê–ù–ò–†–û–í–ê–ù–ò–Ø -->
    <div id="planning-modal" class="modal-overlay hidden">
        <div class="modal-content planning-modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
            <h2>üìã –†–µ–∂–∏–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
            <p>–ü–æ–∫—É–ø–∞–π—Ç–µ –∞–º—É–ª–µ—Ç—ã –∏ –¥—Ä—É–≥–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Å–≤–æ–∏—Ö —à–∞–Ω—Å–æ–≤.</p>
            
            <div class="planning-tickets-info" style="text-align: center; margin: 15px 0; padding: 10px; background-color: var(--cell-bg); border-radius: 4px; border: 1px solid var(--border-color);">
                <span style="color: var(--ticket-color); font-weight: bold;">–í–∞—à–∏ —Ç–∞–ª–æ–Ω—ã: <span id="planning-tickets">0</span>üéüÔ∏è</span>
            </div>
            
            <div class="planning-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                <div class="planning-shop-section">
                    <h3 style="color: var(--ticket-color);">–ú–∞–≥–∞–∑–∏–Ω –∞–º—É–ª–µ—Ç–æ–≤</h3>
                    <div id="planning-shop-items" class="shop-items"></div>
                    <button id="btn-planning-reroll" style="margin-top: 10px; font-size: 12px; padding: 5px 8px;">Reroll (2üéüÔ∏è)</button>
                </div>
                <div class="planning-inventory-section">
                    <h3 style="color: var(--highlight-color);">–í–∞—à–∏ –∞–º—É–ª–µ—Ç—ã</h3>
                    <div id="planning-inventory-items" class="inventory-items"></div>
                </div>
            </div>
            
            <div class="planning-actions" style="text-align: center; margin-top: 20px;">
                <button id="btn-finish-planning">–ó–∞–≤–µ—Ä—à–∏—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
            </div>
        </div>
    </div>
    <div id="end-of-round-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 id="eor-title">–ö–æ–Ω–µ—Ü –†–∞—É–Ω–¥–∞</h2>
            <p>–î–µ–Ω—å –ø–æ–¥—Ö–æ–¥–∏—Ç –∫ –∫–æ–Ω—Ü—É. –í–Ω–µ—Å–∏—Ç–µ —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è –≤ –±–∞–Ω–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ä–∞—É–Ω–¥–µ.</p>
            <div class="modal-stats">
                <span>–ù–∞–ª–∏—á–Ω—ã–µ:</span><span id="eor-coins" style="color: var(--money-color)"></span>
                <span>–í –±–∞–Ω–∫–µ:</span><span id="eor-bank" style="color: var(--money-color)"></span>
            </div>
            <div class="atm-actions" style="position: relative; justify-content: center; max-width: 300px; margin: 20px auto;">
                <button id="btn-eor-deposit">–í–Ω–µ—Å—Ç–∏ ‚ñº</button>
                <div id="eor-deposit-dropdown" class="deposit-dropdown hidden">
                    <div class="deposit-option" data-type="all">–í–Ω–µ—Å—Ç–∏ –≤—Å—ë</div>
                    <div class="deposit-option" data-type="except-7">–í–Ω–µ—Å—Ç–∏ –≤—Å—ë, –∫—Ä–æ–º–µ 7 –ø—Ä–æ–∫—Ä—É—Ç–æ–≤</div>
                    <div class="deposit-option" data-type="except-3">–í–Ω–µ—Å—Ç–∏ –≤—Å—ë, –∫—Ä–æ–º–µ 3 –ø—Ä–æ–∫—Ä—É—Ç–æ–≤</div>
                    <div class="deposit-option" data-type="half">–í–Ω–µ—Å—Ç–∏ –ø–æ–ª–æ–≤–∏–Ω—É</div>
                </div>
            </div>
            <button id="btn-confirm-end-turn">–ó–∞–≤–µ—Ä—à–∏—Ç—å –†–∞—É–Ω–¥</button>
        </div>
    </div>
    <div id="judgement-modal" class="modal-overlay hidden">
         <div class="modal-content">
            <h2 id="judgement-title">–°–£–î–ù–´–ô –î–ï–ù–¨</h2>
            <p id="judgement-text">...–ø–æ–¥—Å—á–µ—Ç –æ–∫–æ–Ω—á–µ–Ω...</p>
            <button id="judgement-continue">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –°–¢–ê–¢–ò–°–¢–ò–ö–ò –ó–ê–ë–ï–ì–ê -->
    <div id="run-stats-modal" class="modal-overlay hidden">
        <div class="modal-content compact-stats-modal" style="max-width: 1000px; padding: 18px 12px;">
            <h2 style="color: var(--highlight-color); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; font-size: 1.1em;">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–±–µ–≥–∞</h2>
            
            <div class="stats-two-columns">
                <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –ü–∞—Å—Å–∏–≤–∫–∏ –∏ —à–∞–Ω—Å—ã -->
                <div class="stats-left-column">
                    <div class="stats-section compact">
                        <h3 style="margin-bottom: 6px; font-size: 1em;">–ü–∞—Å—Å–∏–≤–∫–∏</h3>
                        <div id="stats-active-passives" class="compact-passives-list"></div>
                    </div>
                    <div class="stats-section compact">
                        <h3 style="margin-bottom: 6px; font-size: 1em;">–®–∞–Ω—Å—ã —Å–∏–º–≤–æ–ª–æ–≤</h3>
                        <div id="stats-symbol-chances" class="styled-symbol-chances"></div>
                    </div>
                </div>
                
                <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –õ–∏–Ω–∏–∏ –∏ –º–Ω–æ–∂–∏—Ç–µ–ª–∏ -->
                <div class="stats-right-column">
                    <div class="stats-section compact">
                        <h3 style="margin-bottom: 6px; font-size: 1em;">üé∞ –í—ã–∏–≥—Ä—ã—à–Ω—ã–µ –ª–∏–Ω–∏–∏</h3>
                        <div class="lines-controls" style="text-align: center; margin-bottom: 10px;">
                            <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                            <button class="filter-btn" data-filter="–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è">–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ</button>
                            <button class="filter-btn" data-filter="–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è">–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ</button>
                            <button class="filter-btn" data-filter="–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è">–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ</button>
                            <button class="filter-btn" data-filter="–ó–∏–≥-–ó–∞–≥">–ó–∏–≥-–ó–∞–≥</button>
                            <button class="filter-btn" data-filter="–ù–µ–±–æ/–ó–µ–º–ª—è">–ù–µ–±–æ/–ó–µ–º–ª—è</button>
                            <button class="filter-btn" data-filter="–°–µ–∫—Ä–µ—Ç–Ω–∞—è">–°–µ–∫—Ä–µ—Ç–Ω—ã–µ</button>
                            <button class="filter-btn" data-filter="–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è">–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ</button>
                        </div>
                        <div class="lines-stats" style="text-align: center; margin-bottom: 10px; color: var(--text-color-darker); font-size: 0.9em;">
                            <span id="total-lines">–í—Å–µ–≥–æ –ª–∏–Ω–∏–π: 0</span> | 
                            <span id="visible-lines">–ü–æ–∫–∞–∑–∞–Ω–æ: 0</span>
                        </div>
                        <div id="lines-container" class="lines-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 12px; max-height: 400px; overflow-y: auto;"></div>
                    </div>
                </div>
            </div>
            
            <button id="btn-close-run-stats" style="margin-top: 10px; width: 100%; padding: 8px; background: var(--highlight-color); color: var(--bg-color); border: none; border-radius: 6px; font-weight: bold; font-size: 1em; cursor: pointer; transition: background 0.2s;">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
        <div id="passive-popup" class="passive-popup hidden"></div>
    </div>

    <div id="tutorial-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 500px;">
            <div id="tutorial-pages">
                <!-- –¢—É—Ç–æ—Ä–∏–∞–ª –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç–æ–º -->
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                <button id="tutorial-prev">–ù–∞–∑–∞–¥</button>
                <button id="tutorial-next">–î–∞–ª–µ–µ</button>
            </div>
            <button id="tutorial-close" style="margin-top: 15px; width: 100%;">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>
    
    <script src="items.js"></script>
    <script type="module" src="tutorial.js"></script>
    <script src="passives.js"></script>
    <script src="skript.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const statsModal = document.getElementById('run-stats-modal');
            const showStatsBtn = document.getElementById('btn-show-run-stats');
            const closeStatsBtn = document.getElementById('btn-close-run-stats');

            const passivesContainer = document.getElementById('stats-active-passives');

            function populateStats() {
                console.log('populateStats –≤—ã–∑–≤–∞–Ω–∞');
                console.log('window.state:', window.state);
                console.log('window.symbolWeights:', window.symbolWeights);
                console.log('window.symbols:', window.symbols);
                
                // 1. –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–∞—Å—Å–∏–≤–∫–∏ (—Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏—è-–∫–Ω–æ–ø–∫–∏)
                if (window.state && window.state.activePassives) {
                    const passivesContainer = document.getElementById('stats-active-passives');
                    passivesContainer.innerHTML = '';
                    if (window.state.activePassives.length > 0) {
                        window.state.activePassives.forEach(passive => {
                            const btn = document.createElement('button');
                            btn.className = 'compact-passive-btn';
                            btn.innerHTML = `${passive.emoji || ''} ${passive.name}`;
                            btn.onclick = () => showPassivePopup(passive);
                            passivesContainer.appendChild(btn);
                        });
                    } else {
                        passivesContainer.innerHTML = '<p style="text-align: center; font-size: 0.9em; color: var(--text-color-darker); font-style: italic;">–ù–µ—Ç –ø–∞—Å—Å–∏–≤–æ–∫.</p>';
                    }
                }
                // 2. –®–∞–Ω—Å—ã —Å–∏–º–≤–æ–ª–æ–≤ (–∫—Ä–∞—Å–∏–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏)
                if (window.symbols && window.symbolWeights) {
                    const chancesDiv = document.getElementById('stats-symbol-chances');
                    chancesDiv.innerHTML = '';
                    const removedSymbols = [];
                    if (window.state && window.state.inventory) {
                        const removeItem = window.state.inventory.find(item => item.effect?.remove_symbol);
                        if (removeItem) removedSymbols.push(removeItem.effect.remove_symbol);
                    }
                    
                    // –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤
                    const currentSymbolValues = window.getSymbolCurrentValues ? window.getSymbolCurrentValues() : window.symbols;
                    
                    window.symbols.forEach(symbol => {
                        const weight = window.symbolWeights[symbol.id] || 0;
                        const percentage = window.totalWeight > 0 ? ((weight / window.totalWeight) * 100).toFixed(1) : '0.0';
                        const isRemoved = removedSymbols.includes(symbol.id);
                        
                        // –ù–∞—Ö–æ–¥–∏–º –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–∞
                        const currentSymbol = currentSymbolValues.find(s => s.id === symbol.id);
                        const symbolValue = currentSymbol ? currentSymbol.value : symbol.value;
                        
                        const card = document.createElement('div');
                        card.className = 'styled-symbol-chance';
                        if (isRemoved) card.style.opacity = '0.4';
                        card.innerHTML = `
                            <div class="symbol-value">${symbolValue}üí∞</div>
                            <div class="symbol-emoji">${symbol.graphic}</div>
                            <div class="symbol-name">${symbol.id}</div>
                            <div class="symbol-chance">${percentage}%</div>
                        `;
                        chancesDiv.appendChild(card);
                    });
                }
                
                // 3. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ª–∏–Ω–∏–π —Å —Ç–µ–∫—É—â–∏–º–∏ –º–Ω–æ–∂–∏—Ç–µ–ª—è–º–∏
                renderLinesWithCurrentMultipliers();
            }

            function showPassivePopup(passive) {
                const popup = document.getElementById('passive-popup');
                popup.innerHTML = `
                    <div class="popup-title">${passive.emoji || ''} ${passive.name}</div>
                    <div class="popup-type">${passive.type || ''}</div>
                    <div class="popup-desc">${passive.desc || ''}</div>
                    <button class="popup-close">–ó–∞–∫—Ä—ã—Ç—å</button>
                `;
                popup.classList.remove('hidden');
                popup.querySelector('.popup-close').onclick = () => popup.classList.add('hidden');
                popup.onclick = (e) => { if (e.target === popup) popup.classList.add('hidden'); };
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ç–µ–∫—É—â–∏—Ö –º–Ω–æ–∂–∏—Ç–µ–ª–µ–π –ª–∏–Ω–∏–π
            function calculateCurrentLineMultiplier(line) {
                if (!window.state || !window.state.inventory) return line.multiplier || 1;
                
                let multiplier = line.multiplier || 1;
                
                // –ë–æ–Ω—É—Å—ã –∑–∞ —Ç–∏–ø –ª–∏–Ω–∏–∏
                const typeBonus = window.state.inventory
                    .filter(item => item.effect?.line_type_multiplier_bonus)
                    .reduce((acc, item) => {
                        if (item.effect.line_type_multiplier_bonus.types.some(type => line.type === type)) {
                            return acc + item.effect.line_type_multiplier_bonus.bonus;
                        }
                        return acc;
                    }, 0);
                multiplier += typeBonus;
                
                // –ë–æ–Ω—É—Å—ã –∑–∞ –¥–ª–∏–Ω—É –ª–∏–Ω–∏–∏
                const lengthBonus = window.state.inventory
                    .filter(item => item.effect?.line_length_multiplier_bonus)
                    .reduce((acc, item) => {
                        if (item.effect.line_length_multiplier_bonus.length === line.positions.length) {
                            return acc * item.effect.line_length_multiplier_bonus.multiplier;
                        }
                        return acc;
                    }, 1);
                multiplier *= lengthBonus;
                
                return multiplier;
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —è—á–µ–π–∫–∏ —Å–µ—Ç–∫–∏
            function createCell(position, isHighlighted = false) {
                const cell = document.createElement('div');
                cell.className = `cell${isHighlighted ? ' highlighted' : ''}`;
                cell.setAttribute('data-pos', position);
                cell.style.cssText = `
                    width: 40px; height: 40px; background: #555; border: 2px solid #777; 
                    border-radius: 4px; display: flex; align-items: center; justify-content: center; 
                    font-weight: bold; font-size: 10px; position: relative;
                `;
                
                const number = document.createElement('span');
                number.className = 'cell-number';
                number.textContent = position;
                number.style.cssText = `
                    position: absolute; top: 1px; left: 1px; font-size: 7px; color: #aaa;
                `;
                
                cell.appendChild(number);
                
                if (isHighlighted) {
                    cell.style.background = '#ffd700';
                    cell.style.color = '#000';
                    cell.style.borderColor = '#ffed4e';
                    cell.style.boxShadow = '0 0 8px rgba(255, 215, 0, 0.5)';
                    
                    const target = document.createElement('span');
                    target.textContent = 'üéØ';
                    cell.appendChild(target);
                }
                
                return cell;
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ç–∫–∏
            function createGrid(positions) {
                const grid = document.createElement('div');
                grid.className = 'grid';
                grid.style.cssText = `
                    display: grid; grid-template-columns: repeat(5, 40px); 
                    grid-template-rows: repeat(3, 40px); gap: 2px; margin: 0 auto; 
                    width: fit-content; background: #333; padding: 6px; border-radius: 4px;
                `;
                
                // –°–æ–∑–¥–∞–µ–º 15 —è—á–µ–µ–∫ (3x5 —Å–µ—Ç–∫–∞)
                for (let i = 0; i < 15; i++) {
                    const isHighlighted = positions.includes(i);
                    const cell = createCell(i, isHighlighted);
                    grid.appendChild(cell);
                }
                
                return grid;
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ–∫—Ü–∏–∏ –ª–∏–Ω–∏–∏
            function createLineSection(line) {
                const section = document.createElement('div');
                section.className = 'line-section';
                section.setAttribute('data-type', line.type);
                section.style.cssText = `
                    background: #2a2a2a; padding: 12px; border-radius: 8px; 
                    border: 1px solid #444; margin-bottom: 10px;
                `;
                
                const title = document.createElement('div');
                title.className = 'line-title';
                title.textContent = line.name;
                title.style.cssText = `
                    font-size: 14px; font-weight: bold; color: #ffd700; margin-bottom: 6px;
                `;
                
                const info = document.createElement('div');
                info.className = 'line-info';
                
                const currentMultiplier = calculateCurrentLineMultiplier(line);
                let infoText = `–ü–æ–∑–∏—Ü–∏–∏: [${line.positions.join(', ')}]`;
                if (currentMultiplier !== 1) {
                    infoText += ` | –ú–Ω–æ–∂–∏—Ç–µ–ª—å: <span class="multiplier">${currentMultiplier}x</span>`;
                }
                infoText += ` | –¢–∏–ø: <span class="type">${line.type}</span>`;
                
                info.innerHTML = infoText;
                info.style.cssText = `
                    color: #ccc; font-size: 11px; margin-bottom: 8px;
                `;
                
                const grid = createGrid(line.positions);
                
                section.appendChild(title);
                section.appendChild(info);
                section.appendChild(grid);
                
                return section;
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –ª–∏–Ω–∏–π —Å —Ç–µ–∫—É—â–∏–º–∏ –º–Ω–æ–∂–∏—Ç–µ–ª—è–º–∏
            function renderLinesWithCurrentMultipliers(filter = 'all') {
                const container = document.getElementById('lines-container');
                container.innerHTML = '';
                
                if (!window.PAYLINES) return;
                
                const filteredLines = filter === 'all' 
                    ? window.PAYLINES 
                    : window.PAYLINES.filter(line => line.type === filter);
                
                filteredLines.forEach(line => {
                    const section = createLineSection(line);
                    container.appendChild(section);
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                document.getElementById('total-lines').textContent = `–í—Å–µ–≥–æ –ª–∏–Ω–∏–π: ${window.PAYLINES.length}`;
                document.getElementById('visible-lines').textContent = `–ü–æ–∫–∞–∑–∞–Ω–æ: ${filteredLines.length}`;
            }

            showStatsBtn.addEventListener('click', () => {
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                if (window.updateWeightedSymbols) {
                    window.updateWeightedSymbols();
                }
                populateStats();
                statsModal.classList.remove('hidden');
            });

            closeStatsBtn.addEventListener('click', () => {
                statsModal.classList.add('hidden');
            });
            
            statsModal.addEventListener('click', (event) => {
                if (event.target === statsModal) {
                    statsModal.classList.add('hidden');
                }
            });

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ñ–∏–ª—å—Ç—Ä–∞ –ª–∏–Ω–∏–π
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('filter-btn') && e.target.closest('.lines-controls')) {
                    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                    document.querySelectorAll('.lines-controls .filter-btn').forEach(b => b.classList.remove('active'));
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –Ω–∞–∂–∞—Ç–æ–π –∫–Ω–æ–ø–∫–µ
                    e.target.classList.add('active');
                    
                    // –†–µ–Ω–¥–µ—Ä–∏–º –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–∏–Ω–∏–∏
                    const filter = e.target.getAttribute('data-filter');
                    renderLinesWithCurrentMultipliers(filter);
                }
            });
        });
        
        document.addEventListener('DOMContentLoaded', () => {
            const logWrapper = document.getElementById('log-panel-wrapper');
            const toggleBtn = document.getElementById('btn-toggle-log');
            const closeBtn = document.getElementById('btn-close-log');
            
            if (toggleBtn) {
                toggleBtn.addEventListener('click', () => {
                    logWrapper.classList.toggle('visible');
                });
            }

            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    logWrapper.classList.remove('visible');
                });
            }
        });
    </script>
    <script type="module">
        import { startTutorial } from './tutorial.js';
        window.addEventListener('DOMContentLoaded', () => {
            const btn = document.getElementById('btn-show-tutorial');
            if (btn) btn.onclick = startTutorial;
        });
    </script>
    <script type="module">
        import leaderboardsManager from './leaderboards.js';
        
        // –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–æ–≤
        function initializeLeaderboards(ysdk) {
            console.log('[Leaderboards] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ª–∏–¥–µ—Ä–±–æ—Ä–¥—ã —Å SDK:', ysdk);
            leaderboardsManager.initialize(ysdk).then(success => {
                if (success) {
                    console.log('[Leaderboards] –õ–∏–¥–µ—Ä–±–æ—Ä–¥—ã —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
                } else {
                    console.warn('[Leaderboards] –ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–∏–¥–µ—Ä–±–æ—Ä–¥—ã');
                }
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ SDK
        window.addEventListener('ysdk-ready', (event) => {
            console.log('[Leaderboards] SDK –≥–æ—Ç–æ–≤, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ª–∏–¥–µ—Ä–±–æ—Ä–¥—ã...');
            initializeLeaderboards(event.detail);
        });
        
        // –¢–∞–π–º–∞—É—Ç –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ SDK (5 —Å–µ–∫—É–Ω–¥)
        let sdkTimeout = setTimeout(() => {
            console.warn('[Leaderboards] –¢–∞–π–º–∞—É—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ SDK (5 —Å–µ–∫—É–Ω–¥)');
            if (!window.ysdk && !window.YandexGamesSDK) {
                console.log('[Leaderboards] SDK –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ª–∏–¥–µ—Ä–±–æ—Ä–¥—ã –±—É–¥—É—Ç –æ—Ç–∫–ª—é—á–µ–Ω—ã');
            }
        }, 5000);
        
        // –û—á–∏—â–∞–µ–º —Ç–∞–π–º–∞—É—Ç –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        window.addEventListener('ysdk-ready', () => {
            clearTimeout(sdkTimeout);
        });
        
        window.addEventListener('DOMContentLoaded', () => {
            console.log('[Leaderboards] DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –ø—Ä–æ–≤–µ—Ä—è–µ–º Yandex SDK...');
            console.log('[Leaderboards] window.ysdk:', window.ysdk);
            console.log('[Leaderboards] window.YandexGamesSDK:', window.YandexGamesSDK);
            
            // –ï—Å–ª–∏ SDK —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ä–∞–∑—É
            if (window.ysdk) {
                console.log('[Leaderboards] SDK —É–∂–µ –¥–æ—Å—Ç—É–ø–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º...');
                clearTimeout(sdkTimeout);
                initializeLeaderboards(window.ysdk);
            } else if (window.YandexGamesSDK) {
                console.log('[Leaderboards] –ò—Å–ø–æ–ª—å–∑—É–µ–º YandexGamesSDK...');
                clearTimeout(sdkTimeout);
                initializeLeaderboards(window.YandexGamesSDK);
            } else {
                console.log('[Leaderboards] SDK –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –∂–¥–µ–º —Å–æ–±—ã—Ç–∏—è ysdk-ready...');
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
            const btnLeaderboard = document.getElementById('btn-leaderboard');
            const btnLeaderboardGameover = document.getElementById('btn-leaderboard-gameover');
            
            if (btnLeaderboard) {
                btnLeaderboard.addEventListener('click', () => {
                    console.log('[Leaderboards] –ö–Ω–æ–ø–∫–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ –Ω–∞–∂–∞—Ç–∞');
                    leaderboardsManager.showLeaderboardModal();
                });
            }
            
            if (btnLeaderboardGameover) {
                btnLeaderboardGameover.addEventListener('click', () => {
                    console.log('[Leaderboards] –ö–Ω–æ–ø–∫–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ –≤ game over –Ω–∞–∂–∞—Ç–∞');
                    leaderboardsManager.showLeaderboardModal();
                });
            }
        });
    </script>
    
    <!-- –ú–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º–æ–π -->
    <script type="module">
        import adsManager from './ads.js';
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∫–ª–∞–º—ã
        function initializeAds(ysdk) {
            console.log('[Ads] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∫–ª–∞–º—É —Å SDK:', ysdk);
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ callbacks –¥–ª—è —Å–æ–±—ã—Ç–∏–π —Ä–µ–∫–ª–∞–º—ã
            adsManager.on('onStickyBannerShow', () => {
                console.log('[Ads] –°—Ç–∏–∫–∏-–±–∞–Ω–Ω–µ—Ä –ø–æ–∫–∞–∑–∞–Ω');
                // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ UI
            });
            
            adsManager.on('onStickyBannerHide', () => {
                console.log('[Ads] –°—Ç–∏–∫–∏-–±–∞–Ω–Ω–µ—Ä —Å–∫—Ä—ã—Ç');
                // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ UI
            });
            
            adsManager.on('onFullscreenAdShow', () => {
                console.log('[Ads] –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞ –ø–æ–∫–∞–∑–∞–Ω–∞');
                // –ü—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–≥—Ä—É –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            });
            
            adsManager.on('onFullscreenAdClose', (wasShown) => {
                console.log('[Ads] –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞ –∑–∞–∫—Ä—ã—Ç–∞, –±—ã–ª–∞ –ø–æ–∫–∞–∑–∞–Ω–∞:', wasShown);
                // –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º –∏–≥—Ä—É
            });
            
            adsManager.on('onRewardedVideoReward', () => {
                console.log('[Ads] –í–∏–¥–µ–æ—Ä–µ–∫–ª–∞–º–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–∞, –≤—ã–¥–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É');
                // –í—ã–¥–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É –∏–≥—Ä–æ–∫—É
                if (window.state) {
                    // –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–Ω–µ—Ç—ã –∏–ª–∏ —Ç–∞–ª–æ–Ω—ã
                    window.state.coins += 100;
                    window.state.tickets += 5;
                    if (window.updateUI) {
                        window.updateUI();
                    }
                }
            });
            
            adsManager.on('onAdError', (adType, error) => {
                console.error('[Ads] –û—à–∏–±–∫–∞ —Ä–µ–∫–ª–∞–º—ã:', adType, error);
                // –ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
            });
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–∫–ª–∞–º—ã
            adsManager.updateSettings({
                stickyBannerEnabled: true,
                stickyBannerPosition: 'right',
                autoShowStickyBanner: true,
                showAdsOnGameStart: false, // –û—Ç–∫–ª—é—á–∞–µ–º –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –∏–≥—Ä—ã
                showAdsOnLevelComplete: true,
                showAdsOnGameOver: true
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ SDK
        window.addEventListener('ysdk-ready', (event) => {
            console.log('[Ads] SDK –≥–æ—Ç–æ–≤, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∫–ª–∞–º—É...');
            initializeAds(event.detail);
        });
        
        // –ï—Å–ª–∏ SDK —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω
        if (window.ysdk) {
            console.log('[Ads] SDK —É–∂–µ –¥–æ—Å—Ç—É–ø–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∫–ª–∞–º—É...');
            initializeAds(window.ysdk);
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º–æ–π
        window.showRewardedVideo = () => {
            return adsManager.showRewardedVideo();
        };
        
        window.showFullscreenAd = () => {
            return adsManager.showFullscreenAd();
        };
        
        window.toggleStickyBanner = () => {
            if (adsManager.isStickyBannerShown()) {
                return adsManager.hideStickyBanner();
            } else {
                return adsManager.showStickyBanner();
            }
        };
        
        // –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –æ—Ç–ª–∞–¥–∫–∏ —Ä–µ–∫–ª–∞–º—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            document.addEventListener('DOMContentLoaded', () => {
                // –°–æ–∑–¥–∞–µ–º –ø–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏ —Ä–µ–∫–ª–∞–º—ã
                const debugPanel = document.createElement('div');
                debugPanel.className = 'ads-debug-info';
                debugPanel.innerHTML = `
                    <h4>–†–µ–∫–ª–∞–º–∞</h4>
                    <p>–°—Ç–∞—Ç—É—Å: <span id="ads-status">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
                    <p>–°—Ç–∏–∫–∏-–±–∞–Ω–Ω–µ—Ä: <span id="sticky-status">-</span></p>
                    <p>SDK: <span id="sdk-status">-</span></p>
                `;
                document.body.appendChild(debugPanel);
                
                // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º–æ–π
                const controlsPanel = document.createElement('div');
                controlsPanel.className = 'ads-controls';
                controlsPanel.innerHTML = `
                    <button class="ads-control-btn" onclick="toggleStickyBanner()">–°—Ç–∏–∫–∏-–±–∞–Ω–Ω–µ—Ä</button>
                    <button class="ads-control-btn" onclick="showFullscreenAd()">–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–∞—è</button>
                    <button class="ads-control-btn" onclick="showRewardedVideo()">–í–∏–¥–µ–æ —Å –Ω–∞–≥—Ä–∞–¥–æ–π</button>
                `;
                document.body.appendChild(controlsPanel);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
                setInterval(() => {
                    const debugInfo = adsManager.getDebugInfo();
                    document.getElementById('ads-status').textContent = debugInfo.isInitialized ? '–ì–æ—Ç–æ–≤' : '–ù–µ –≥–æ—Ç–æ–≤';
                    document.getElementById('sticky-status').textContent = debugInfo.stickyBannerShown ? '–ü–æ–∫–∞–∑–∞–Ω' : '–°–∫—Ä—ã—Ç';
                    document.getElementById('sdk-status').textContent = debugInfo.ysdkAvailable ? '–î–æ—Å—Ç—É–ø–µ–Ω' : '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                }, 2000);
            });
        }
    </script>
</body>
</html>