@import url('https://fonts.googleapis.com/css2?family=Special+Elite&display=swap');

:root {
    --bg-color: #000000;
    --cell-bg: #1a1a1a;
    --panel-bg: #0a0a0a;
    --text-color: #c7b39a;
    --highlight-color: #4CAF50; /* Sickly green */
    --danger-color: #9a1111; /* Deep blood red */
    --money-color: #b08d57; /* Tarnished gold */
    --ticket-color: #7b42f5; /* Ethereal violet */
    --luck-color: #00bcd4; /* Ghostly cyan */
    --border-color: #332d25;
    --rarity-common: #8a8a8a;
    --rarity-rare: #536dfe;
    --rarity-legendary: #ffab40;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

@keyframes flicker {
  0%, 100% { opacity: 1; text-shadow: 0 0 2px var(--danger-color), 0 0 5px var(--danger-color); }
  50% { opacity: 0.8; text-shadow: 0 0 3px var(--danger-color); }
}

@keyframes breath {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.03); }
}

body {
    font-family: 'Special Elite', monospace;
    background-color: var(--bg-color);
    color: var(--text-color);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    overflow: hidden;
    background-image:
        radial-gradient(ellipse at center, rgba(0,0,0,0) 0%, rgba(0,0,0,0.9) 80%, #000 100%),
        url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Cg fill-rule="evenodd"%3E%3Cg fill="%231a1a1a" fill-opacity="0.4"%3E%3Cpath opacity=".5" d="M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm-9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-à´ˆ-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm-9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm-9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm-9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9z"/%3E%3cpath d="M6 5V0h1v5h5v1H6v5H5V6H0V5h5z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');
}

.game-container {
    display: flex; gap: 20px; padding: 20px; width: 100%; max-width: 1300px;
}
.main-panel { flex-grow: 1; display: flex; flex-direction: column; gap: 20px; }
.slot-area { display: flex; align-items: stretch; gap: 20px; }

.slot-machine {
    display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; padding: 15px;
    border: 2px solid var(--border-color); background-color: var(--panel-bg);
    border-radius: 8px; box-shadow: 0 0 30px rgba(0,0,0,0.9), inset 0 0 15px #000;
    flex-grow: 1;
}

.slot-cell {
    background-color: var(--cell-bg); border: 1px solid var(--border-color);
    border-radius: 4px; overflow: hidden; position: relative;
    aspect-ratio: 1 / 1; transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
    box-shadow: inset 0 0 8px #000;
}
.slot-cell .reel { position: absolute; top: 0; left: 0; right: 0; height: 2000%; }
.slot-cell .symbol {
    width: 100%; height: 5%; display: flex; align-items: center; justify-content: center;
    font-size: 2.2em; padding: 10%; filter: drop-shadow(0 0 2px #000);
}

.slot-cell.highlight, .slot-cell.highlight-big, .slot-cell.highlight-huge {
    z-index: 10; animation: eerieGlow 1s ease-in-out infinite;
}
.slot-cell.highlight { --glow-color: var(--highlight-color); transform: scale(1.05); }
.slot-cell.highlight-big { --glow-color: var(--money-color); transform: scale(1.08); }
.slot-cell.highlight-huge { --glow-color: var(--ticket-color); transform: scale(1.12); }

.lever-container {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    background-color: var(--panel-bg); border: 2px solid var(--border-color);
    padding: 20px 15px; border-radius: 8px; box-shadow: inset 0 0 10px #000;
}
.lever-base { width: 50px; height: 30px; background: #222; border-radius: 5px 5px 0 0; border: 1px solid #444; }
.lever {
    width: 12px; height: 100px; background: linear-gradient(to right, #444, #777, #444);
    position: relative; cursor: pointer; transition: transform 0.2s;
    transform-origin: bottom center; border: 1px solid #111;
}
.lever-handle {
    width: 32px; height: 32px; background: radial-gradient(circle, #a02020, var(--danger-color));
    border-radius: 50%; position: absolute; top: -16px; left: -10px;
    box-shadow: 0 0 10px var(--danger-color), inset 0 0 5px #ff8a8a;
}
.lever.pulled { transform: rotate(45deg); cursor: not-allowed; }
.lever:not(.pulled):hover { transform: scale(1.1); }
.lever:not(.pulled):hover .lever-handle { box-shadow: 0 0 15px #ff5555, inset 0 0 7px #ffaaaa; }

.controls {
    padding: 15px; border: 2px solid var(--border-color); background-color: var(--panel-bg);
    border-radius: 8px; text-align: center; display: flex;
    justify-content: space-around; align-items: center; box-shadow: inset 0 0 10px #000;
}

.log-panel {
    height: 150px; padding: 15px; border: 2px solid var(--border-color);
    background-color: var(--panel-bg); border-radius: 8px; overflow-y: auto;
    font-size: 14px; display: flex; flex-direction: column-reverse;
    box-shadow: inset 0 0 10px #000;
}
.log-panel p { margin-bottom: 5px; letter-spacing: 1px; }

.ui-panel { width: 350px; display: flex; flex-direction: column; gap: 20px; flex-shrink: 0; }
.ui-box {
    padding: 15px; border: 2px solid var(--border-color);
    background-color: var(--panel-bg); border-radius: 8px;
    box-shadow: inset 0 0 10px #000;
}
.ui-box h3 {
    margin-bottom: 10px; border-bottom: 1px solid var(--border-color);
    padding-bottom: 5px; color: var(--highlight-color);
    text-transform: uppercase; letter-spacing: 2px;
}

#stat-debt {
    animation: flicker 4s linear infinite;
    font-weight: bold;
}

.stats-grid { display: grid; grid-template-columns: auto 1fr; gap: 10px; font-size: 15px; }
.stats-grid span:nth-child(odd) { text-align: left; padding-right: 10px; opacity: 0.8; }
.shop-items, .inventory-items { display: flex; flex-direction: column; gap: 10px; max-height: 150px; overflow-y: auto; padding-right: 5px; }

.item {
    padding: 10px; border: 1px solid var(--border-color); background-color: var(--cell-bg);
    border-radius: 4px; cursor: pointer; transition: background-color 0.2s, border-color 0.2s;
    position: relative; box-shadow: 2px 2px 5px #000;
}
.item:hover:not(:disabled) { background-color: #2a2a2a; border-color: var(--highlight-color); }
.item.rarity-common { border-left: 5px solid var(--rarity-common); }
.item.rarity-rare { border-left: 5px solid var(--rarity-rare); }
.item.rarity-legendary { border-left: 5px solid var(--rarity-legendary); }

.item-name { font-weight: bold; }
.item-cost { float: right; color: var(--ticket-color); font-weight: bold; }
.item-desc { font-size: 13px; color: #998a76; margin-top: 5px; }

.atm-actions { display: flex; gap: 10px; margin-top: 10px; }
.atm-actions input {
    flex-grow: 1; background-color: var(--cell-bg); border: 1px solid var(--border-color);
    color: var(--text-color); padding: 8px; font-family: 'Special Elite', monospace; border-radius: 4px;
    width: 50%;
}

button {
    font-family: 'Special Elite', monospace; padding: 10px 20px;
    border: 1px solid var(--border-color); background-color: var(--cell-bg);
    color: var(--text-color); cursor: pointer; border-radius: 4px;
    font-size: 16px; transition: all 0.2s; letter-spacing: 1px;
    text-transform: uppercase;
}
button:hover:not(:disabled) {
    background-color: var(--highlight-color); color: var(--bg-color);
    border-color: var(--highlight-color); text-shadow: 0 0 5px var(--bg-color);
}
button:disabled { cursor: not-allowed; opacity: 0.5; filter: grayscale(80%); }

#btn-end-turn, #btn-confirm-end-turn { background-color: var(--danger-color); border-color: #c82333; }
#btn-end-turn:hover:not(:disabled), #btn-confirm-end-turn:hover:not(:disabled) {
    background-color: #c82333; border-color: var(--text-color); color: var(--text-color);
}

.modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.8); display: flex; justify-content: center;
    align-items: center; z-index: 1000; text-align: center; padding: 20px;
    backdrop-filter: blur(8px);
    background-image: radial-gradient(ellipse at center, rgba(0,0,0,0) 0%, rgba(0,0,0,0.95) 90%, #000 100%);
}
.modal-content {
    background-color: var(--panel-bg); padding: 30px; border-radius: 8px;
    border: 2px solid var(--border-color); max-width: 500px;
    box-shadow: 0 0 40px #000, 0 0 15px var(--danger-color);
}
.modal-content h2 { margin-bottom: 15px; color: var(--highlight-color); letter-spacing: 3px; }
.modal-content p { margin-bottom: 25px; line-height: 1.6; font-size: 17px; }
.modal-content button { margin: 5px; }
.modal-stats { text-align: left; max-width: 300px; margin: 20px auto; display: grid; grid-template-columns: auto 1fr; gap: 8px;}
#game-over-screen .modal-content h2, #judgement-modal .modal-content h2.failure {
    color: var(--danger-color); animation: breath 2s ease-in-out infinite;
}
.hidden { display: none; }
.shake { animation: shake 0.8s infinite; }

@keyframes shake {
    0%, 100% { transform: translate(0, 0) rotate(0); }
    10%, 90% { transform: translate(-3px, 0) rotate(-1deg); }
    20%, 80% { transform: translate(3px, 0) rotate(1deg); }
    30%, 50%, 70% { transform: translate(-3px, 0) rotate(1deg); }
    40%, 60% { transform: translate(3px, 0) rotate(-1deg); }
}
@keyframes eerieGlow {
  0%, 100% { box-shadow: 0 0 8px var(--glow-color), inset 0 0 5px var(--glow-color); border-color: var(--glow-color); }
  50% { box-shadow: 0 0 15px var(--glow-color), inset 0 0 10px var(--glow-color); border-color: var(--glow-color); }
}